== Overview
This is a Rack application for maximum performance.
confg.ru - is the rackup file
models/redirector.rb - is the application


== Implementation
Redirector has an instance method called to_uri_and_queue, this calls to_uri for the uri massaging then tucks the data into the que.

Additional data massaging can be performed in either method.

The to_uri method is well tested in the tests/app_tests.rb file, add addtional tests in that file.

Run locally via rackup

$rackup config.ru

http://localhost:9292/dcsml4w3quz5bdovt759v8qne_9g3l/fbtabs.stepchangegroup.com/webtrends/index.html?WT.custom=1&myapp=blah

@@@
[2010-03-22 12:24:22] INFO  WEBrick 1.3.1
[2010-03-22 12:24:22] INFO  ruby 1.8.6 (2009-06-08) [i686-darwin10.0.0]
[2010-03-22 12:24:22] INFO  WEBrick::HTTPServer#start: pid=3944 port=9292
Add to que: {"dcsua"=>"Mozilla/5.0 (Macintosh; U; Intel Mac OS X 10.6; en-US; rv:1.9.1.8) Gecko/20100202 Firefox/3.5.8", "final_uri"=>"http://fbtabs.stepchangegroup.com/webtrends/index.html?myapp=blah", "dcsid"=>"dcsml4w3quz5bdovt759v8qne_9g3l"}
Redirect to: 
127.0.0.1 - - [22/Mar/2010 12:24:28] "GET /dcsml4w3quz5bdovt759v8qne_9g3l/fbtabs.stepchangegroup.com/webtrends/index.html?WT.custom=1&myapp=blah HTTP/1.1" 301 14 0.0037
@@@

== EY RabbitMQ install notes
download source, unzip
sudo emerge dev-python/simplejson
sudo emerge dev-lang/erlang
make
sudo rabbitmq-server

sudo rabbitmqctl start_app

== Unicorn notes
Every time you manually screw with the rails app you MUST restart 
unicorn. This done with sudo /etc/init.d/unicorn_wt_redirector stop 
followed by sudo /etc/init.d/unicorn_wt_redirector start

The unicorn logs are in /data/wt_redirector/current/log